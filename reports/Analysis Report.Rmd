---
title: "Analysis Report"
author: "Vaishnavi Jeurkar"
date: "2023-11-07"
output: pdf_document
---

# Learning Analytics | FutureLearn MOOC Dataset

### Introduction
The objective of this project is to identify the key determinants of student engagement in the Massive Open Online Course (MOOC) titled "Cyber Security: Safety At Home, Online, and in Life," offered by Newcastle University through the FutureLearn platform. This study leverages raw data collected from seven different runs of the course, utilizing learning analytics techniques to uncover effective measures of student engagement. The insights derived from this analysis hold the potential to inform the course's learning design and facilitate intervention processes for at-risk students. These findings are of paramount importance Newcastle University's course instructors and individuals running similar online courses, as they seek to enhance student success rates and implement targeted marketing strategies. Employing the CRISP-DM framework, this report presents the results of two iterative cycles of data mining, which will serve as a valuable resource for improving the course's effectiveness and promoting it in a manner that aligns with the needs of the target audience.

### Round 1
### Business Understanding


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath('..'))
```

```{r ProjectTemplate, include=FALSE}
library(ProjectTemplate)
library(tidyverse)
library("RColorBrewer")
library(ggpubr)
library(ggplot2)
library(ggridges)
library(fmsb)
library(GGally)
load.project()
```

```{r}
step_activity_data = read.csv("data/cyber-security-7_step-activity.csv")
glimpse(step_activity_data)
```
```{r}
step_activity_data %>%
  summarize(distinct_points = n_distinct(learner_id))
#gives total number of learner id
```
```{r}
step_activity_data = step_activity_data %>%
  mutate(last_completed_at = replace(last_completed_at, last_completed_at ==  "", NA))
step_activity_data %>%
  summarise(count = sum(is.na(last_completed_at)))
#replacing empty strings in last_completed_at column with NA to count the empty values
```
```{r}
#difference in seconds

step_activity_data$time_to_complete = as.numeric(difftime(step_activity_data$last_completed_at, 
                                                          step_activity_data$first_visited_at, units ="mins"))
step_activity_data
```
```{r}
boxplot_plot <- ggplot(data = subset(step_activity_data, !is.na(time_to_complete)), 
                       aes(x = factor(step), y = time_to_complete/60)) +
  geom_boxplot() +
  labs(
    title = "Stepwise Boxplot of Time to Complete",
    x = "Step",
    y = "Time to Complete"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.text = element_text(size = 6),
    axis.title = element_text(size = 14),
  )

# Display the stepwise boxplot
print(boxplot_plot)
```



```{r}
data_summary = step_activity_data %>% 
  group_by(step_number, week_number) %>% 
  summarize(AvgTimeTaken = mean(time_to_complete/60, na.rm = TRUE), 
            PercentIncomplete = mean(is.na(time_to_complete)) * 100)

```
```{r}
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
sc <- scale_colour_gradientn(colours = myPalette(100), limits=c(1, 3))

ggdotchart(
  data_summary, x = "step_number", y = "AvgTimeTaken", 
  group = "week_number", color="week_number",
  add = "segment", position = position_dodge(0.3),
  sorting = "none"
  ) +  scale_colour_gradientn(guide = 'colourbar', colours = brewer.pal(n = 3, name = 'Set1'))
```
```{r}
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
sc <- scale_colour_gradientn(colours = myPalette(100), limits=c(1, 3))

ggdotchart(
  data_summary, x = "step_number", y = "PercentIncomplete", 
  group = "week_number", color="week_number",
  add = "segment", position = position_dodge(0.3),
  sorting = "none"
  ) +  scale_colour_gradientn(guide = 'colourbar', colours = brewer.pal(n = 3, name = 'Set1'))
```



```{r}
result <- step_activity_data %>%
  group_by(learner_id) %>%
  summarize(last_completed_step = max(step, na.rm = TRUE)) %>%
  arrange(learner_id)

bar_chart <- ggplot(result, aes(x = factor(last_completed_step))) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(
    title = "Student Drop-Out Count by Step",
    x = "Last Completed Step",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Display the bar chart
print(bar_chart)

```

Learner engagement with different types of material


```{r}
video_stats = read.csv("data/cyber-security-7_video-stats.csv")
glimpse(video_stats)
```
```{r}
correlation_result <- video_stats %>%
  summarize(correlation = cor(video_duration, total_views))
print(correlation_result)
```

```{r}
video_stats <- video_stats %>%
  rename(
    Five = viewed_five_percent,
    Ten = viewed_ten_percent,
    TwentyFive = viewed_twentyfive_percent,
    Fifty = viewed_fifty_percent,
    SeventyFive = viewed_seventyfive_percent,
    NinetyFive = viewed_ninetyfive_percent,
    Hundred = viewed_onehundred_percent
  )
```

```{r}
ggparcoord(data = video_stats,
           columns = 9:15,
           groupColumn = "title",
           showPoints = TRUE,
           scale = "globalminmax")+
           scale_x_discrete(guide = guide_axis(n.dodge=3))
```
```{r}
question_response = read.csv("data/cyber-security-7_question-response.csv")
glimpse(question_response)
```
```{r}
#remove rows where learner id is null
question_response <- question_response %>%
  filter(!(learner_id == ""))
glimpse(question_response)
```


```{r}
# Define the list of week_number and step_number combinations
combinations <- list(
  list(week_number = 1, step_number = 8),
  list(week_number = 2, step_number = 8),
  list(week_number = 2, step_number = 20),
  list(week_number = 3, step_number = 11),
  list(week_number = 3, step_number = 18)
)

# Initialize an empty list to store the results
correctIncomplete <- list()
incorrectComplete <- list()
correctComplete <- list()

# Iterate through the combinations and filter the data
for (comb in combinations) {
  # Filter step_activity_data for learners who completed all steps for the combination
  completed_learners <- step_activity_data %>%
    filter(week_number == comb$week_number) %>%
    group_by(learner_id) %>%
    filter(max(step_number) >= comb$step_number) %>%
    pull(learner_id)
  
  # Filter question_response for correct responses after not completing the steps for the combination
  correct_response_without_completion <- question_response %>%
    filter(
      week_number == comb$week_number,
      step_number == comb$step_number,
      !learner_id %in% completed_learners,  # Exclude students who completed steps
      correct == "true"  # Filter for correct responses
    )
  
  # Number of students with correct responses after not completing the steps for the combination
  num_students_with_correct_response_without_completion <- correct_response_without_completion %>% nrow()
  # Store the result in the results list
  correctIncomplete[[paste("Week", comb$week_number, "Step", comb$step_number)]] <-               
  num_students_with_correct_response_without_completion
  
  incorrect_response_with_completion <- question_response %>%
    filter(
      week_number == comb$week_number,
      step_number == comb$step_number,
      learner_id %in% completed_learners,  # Exclude students who completed steps
      correct == "false"  # Filter for correct responses
    )
  
  num_students_with_incorrect_response_with_completion <- incorrect_response_with_completion %>% nrow()
  
  incorrectComplete[[paste("Week", comb$week_number, "Step", comb$step_number)]] <- num_students_with_incorrect_response_with_completion
  
  correct_response_with_completion <- question_response %>%
    filter(
      week_number == comb$week_number,
      step_number == comb$step_number,
      learner_id %in% completed_learners,  # Exclude students who completed steps
      correct == "true"  # Filter for correct responses
    )
  
  num_students_with_correct_response_with_completion <- correct_response_with_completion %>% nrow()
  
  correctComplete[[paste("Week", comb$week_number, "Step", comb$step_number)]] <- num_students_with_correct_response_with_completion
}
print("Students with completed steps but incorrect answers")
# Print the results
for (res in incorrectComplete) {
  print(res)
}

print("Students with incomplete steps but correct answers")
# Print the results
for (res in correctIncomplete) {
  print(res)
}

print("Students with completed steps and correct answers")
# Print the results
for (res in correctComplete) {
  print(res)
}

```
```{r}
result <- question_response %>%
  group_by(learner_id, quiz_question) %>%
  summarise(total_true = sum(correct == "true"),
            total_false = sum(correct == "false"))

avg_attempts = result %>%
  group_by(quiz_question) %>%
  summarise(max(total_false),
            sum(total_false))

# Print the result
print(avg_attempts)
```


